% Question-level list
\newlist{qlist}{enumerate}{1}

\ifbool{setmanyquests}{
    \setlist[qlist]{leftmargin=11mm, labelwidth=8mm, labelsep=3mm, label={\bfseries\arabic*.\hspace{\fboxsep}}, listparindent=0mm, itemindent=0mm}
  }{
    \setlist[qlist]{leftmargin=9mm, labelwidth=6mm, labelsep=3mm, label={\bfseries\arabic*.\hspace{\fboxsep}}, listparindent=0mm, itemindent=0mm}
  }

% Main question numering counter
\newcounter{qnum}

% Numbered Questions: Normal numbering & optional title
\DeclareDocumentEnvironment{nquest}{o}
  {
    \begin{qlist}
    \setcounter{qlisti}{\value{qnum}}\refstepcounter{qnum}
    \item\IfValueTF{#1}{{\color{headingcol}\bfseries #1\par}}{}
  }
  {\end{qlist}\medskip}

% Numbered Questions: Framed numbering & optional title
\DeclareDocumentEnvironment{nfquest}{o}
  {
    \begin{qlist}[label={\fbox{\bfseries\arabic*.}}]
    \setcounter{qlisti}{\value{qnum}}\refstepcounter{qnum}
    \item\IfValueTF{#1}{{\color{headingcol}\bfseries #1\par}}{}
  }
  {\end{qlist}\medskip}

% Unumbered Questions: Mandatory title
\DeclareDocumentEnvironment{quest}{m}
  {\begin{qlist}[label={}]\item{\color{headingcol}\bfseries #1\par}}
  {\end{qlist}\medskip}